---
title: "Project Code"
author: "Jill Reiner"
date: "6/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(ggbeeswarm)
nwsl <- read.csv("~/Desktop/CMSAC Projects/nwsl_season_stats.csv")
```

```{r}
playoff_teams_2019 <- nwsl %>%
  filter(team_id %in% c("NC", "CHI", "POR", "SEA")) %>%
  group_by(team_id) %>%
  summarize(total_reg_season_goals = sum(goals))
```

```{r}
playoff_teams_2019 %>%
  ggplot(aes(x = team_id, fill = team_id)) +
  geom_bar(aes(y = total_reg_season_goals),
           stat = "identity") +
  scale_fill_manual("Teams", values = c("CHI" = "lightblue", 
                                         "NC" = "darkblue", 
                                         "POR" = "darkred",
                                         "SEA" = "gold")) + 
  labs(x = "Team", y = "Total Regular Season Goals",
       title = "Regular Season Goals per Team",
       subtitle = "2019 NWSL Playoff Teams") +
  theme_bw()
```

```{r}
last_three_champs <- nwsl %>%
  filter((team_id == "NC" & season == 2019) | (team_id == "NC" & season == 2018) | (team_id == "POR" & season == 2017),
         goals > 0) %>%
  mutate(g_permatch = goals / matches) %>%
  group_by(season, team_id) %>%
  summarise(regseason_goals_per_match = sum(g_permatch))
```

```{r}
last_three_champs %>%
  ggplot(aes(x = season, fill = team_id)) +
  geom_bar(aes(y = regseason_goals_per_match),
           stat = "identity") +
  scale_fill_manual("Teams", values = c( "NC" = "darkblue", 
                                         "POR" = "darkred")) + 
  labs(x = "Team", y = "Regular Season Goals per Match",
       title = "Regular Season Goals per Match",
       subtitle = "Last Three NWSL Championship Winning Teams") +
  theme_bw()
```